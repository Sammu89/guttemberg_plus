/**
 * Tabs Block - Frontend Styles
 *
 * Provides core styling for tabs functionality on the frontend.
 * Supports both horizontal and vertical orientations.
 * Uses CSS custom properties from schema (single source of truth).
 *
 * @package
 * @since 1.0.0
 */

@use 'theme-generated';

/* Block wrapper */
.gutplus-tabs {
	overflow: clip;
	border: var(--tabs-border-width) var(--tabs-border-style) var(--tabs-border-color);
	border-radius: var(--tabs-border-radius);
	box-shadow: var(--tabs-border-shadow);
	transition: box-shadow 0.2s ease;
	margin-top: 1em;
	margin-bottom: 1em;

	&:hover {
		box-shadow: var(--tabs-border-shadow-hover);
	}

	// Alignment classes
	&.gutplus-align-left {
		margin-left: 0 !important;
		margin-right: auto !important;
	}

	&.gutplus-align-center {
		margin-left: auto !important;
		margin-right: auto !important;
	}

	&.gutplus-align-right {
		margin-left: auto !important;
		margin-right: 0 !important;
	}
}

/* Tab list (navigation) */
.tabs-list {
	display: flex;
	gap: 0.5rem;
	background-color: var(--tabs-list-bg);
	justify-content: var(--tabs-list-align);
	overflow-x: auto;
	padding: 0.5rem;
	padding-bottom: 0;
	outline: none !important;
	/* Divider border - bottom edge on horizontal (controlled by enableDividerBorder toggle) */
	border-bottom: var(--tabs-divider-border-width) var(--tabs-divider-border-style) var(--tabs-divider-border-color);

	/* Base vertical - shared by both left and right */
	&[role="tablist"][aria-orientation="vertical"] {
		flex-direction: column;
		border-bottom: none;
	}

	/* Vertical-left: nav on left, border on right */
	.gutplus-tabs[data-orientation="vertical-left"] &[role="tablist"] {
		padding-right: 0;
		border-right: var(--tabs-divider-border-width) var(--tabs-divider-border-style) var(--tabs-divider-border-color);
	}

	/* Vertical-right: nav on right, border on left */
	.gutplus-tabs[data-orientation="vertical-right"] &[role="tablist"] {
		padding-left: 0;
		border-left: var(--tabs-divider-border-width) var(--tabs-divider-border-style) var(--tabs-divider-border-color);
	}
}

/* Tab heading wrapper (when headingLevel is set) */
.tab-heading {
	margin: 0;
	padding: 0;
	display: contents; // Makes heading transparent to flexbox layout
}

/* Tab button */
.tab-button {
	padding: 0.75rem 1.5rem;
	background-color: var(--tabs-button-bg);
	color: var(--tabs-button-color);
	font-size: var(--tabs-button-font-size);
	font-weight: var(--tabs-button-font-weight);
	font-style: var(--tabs-button-font-style);
	text-transform: var(--tabs-button-text-transform);
	text-decoration: var(--tabs-button-text-decoration);
	text-align: var(--tabs-button-text-align);
	border: var(--tabs-button-border-width) var(--tabs-button-border-style) var(--tabs-button-border-color);
	border-radius: var(--tabs-button-border-radius);
	box-shadow: var(--tabs-button-border-shadow);
	cursor: pointer;
	white-space: nowrap;
	transition: color 0.2s ease, border-color 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease;
	outline: none !important;
	display: block;
	width: 100%;

	/* Focus border - bottom edge on horizontal */
	border-bottom: var(--tabs-focus-border-width) var(--tabs-focus-border-style) var(--tabs-focus-border-color);

	&:hover:not(:disabled) {
		color: var(--tabs-button-hover-color);
		background-color: var(--tabs-button-hover-bg);
		box-shadow: var(--tabs-button-border-shadow-hover);
	}

	&:focus {
		// Use same colors as normal state to prevent theme CSS override
		background-color: var(--tabs-button-bg);
		color: var(--tabs-button-color);
		// Inset box-shadow with blur for darker gradient entering from edges
		box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.05);
		// Override WordPress global focus outline style
		outline: none;
	}

	&.active,
	&[aria-selected="true"] {
		color: var(--tabs-button-active-color);
		background-color: var(--tabs-button-active-bg);
		border-color: var(--tabs-button-active-border-color);
		border-bottom-color: var(--tabs-button-active-border-bottom-color);
		/* Focus border active color for horizontal */
		border-bottom-color: var(--tabs-focus-border-color-active);
	}

	&:disabled {
		opacity: 0.5;
		cursor: not-allowed;
	}

	/* Vertical-left: focus border on right, active tab connects to panel */
	.gutplus-tabs[data-orientation="vertical-left"] .tabs-list & {
		/* Reset bottom to normal button border (not focus border) */
		border-bottom: var(--tabs-button-border-width) var(--tabs-button-border-style) var(--tabs-button-border-color);
		/* Focus border moves to right edge */
		border-right: var(--tabs-focus-border-width) var(--tabs-focus-border-style) var(--tabs-focus-border-color);

		&.active,
		&[aria-selected="true"] {
			/* Hide right border to connect with panel */
			border-right-color: var(--tabs-panel-bg, #ffffff);
			/* Ensure other borders stay consistent */
			border-top-color: var(--tabs-button-border-color);
			border-bottom-color: var(--tabs-button-border-color);
			border-left-color: var(--tabs-button-border-color);
		}
	}

	/* Vertical-right: focus border on left, active tab connects to panel */
	.gutplus-tabs[data-orientation="vertical-right"] .tabs-list & {
		/* Reset bottom to normal button border (not focus border) */
		border-bottom: var(--tabs-button-border-width) var(--tabs-button-border-style) var(--tabs-button-border-color);
		/* Focus border moves to left edge */
		border-left: var(--tabs-focus-border-width) var(--tabs-focus-border-style) var(--tabs-focus-border-color);

		&.active,
		&[aria-selected="true"] {
			/* Hide left border to connect with panel */
			border-left-color: var(--tabs-panel-bg, #ffffff);
			/* Ensure other borders stay consistent */
			border-top-color: var(--tabs-button-border-color);
			border-bottom-color: var(--tabs-button-border-color);
			border-right-color: var(--tabs-button-border-color);
		}
	}
}

/* Tab icon (rendered when showIcon is true in JS) */
.tab-icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	color: var(--tabs-icon-color);
	font-size: var(--tabs-icon-size);
	margin-right: 0.5rem;
	transition: transform 300ms ease, opacity 300ms ease;

	/* Icon rotation (for open/close states, controlled via JS) */
	&.is-rotated {
		transform: rotate(var(--tabs-icon-rotation));
	}

	/* Image icon */
	&.tab-icon-image {
		width: var(--tabs-icon-size);
		height: var(--tabs-icon-size);
		object-fit: contain;
		transition: opacity 300ms ease;
	}
}

/* Tabs panels container */
.tabs-panels {
	position: relative;
	outline: none !important;
}

/* Tab panel */
.tab-panel {
	background-color: var(--tabs-panel-bg);
	color: var(--tabs-panel-color);
	border: var(--tabs-panel-border-width) var(--tabs-panel-border-style) var(--tabs-panel-border-color);
	border-radius: var(--tabs-panel-border-radius);
	overflow: hidden;
	outline: none !important;

	&[hidden] {
		display: none;
	}

	&.active {
		animation: fadeIn 200ms ease-in-out;
	}
}

/* Tab panel inner wrapper */
.tab-panel-inner {
	padding: 1.5rem;
}

/* Fade-in animation */
@keyframes fadeIn {

	from {
		opacity: 0;
		transform: translateY(10px);
	}

	to {
		opacity: 1;
		transform: translateY(0);
	}
}

/* Responsive accordion fallback */
.accordion-fallback {
	display: none;

	.responsive-accordion & {

		@media (max-width: 768px) {
			display: block;
		}
	}
}

/* Layout variations */

/* Vertical-left layout: nav on left, content on right */
.gutplus-tabs[data-orientation="vertical-left"] {
	display: flex;
	flex-direction: row;
	gap: 0;
	align-items: stretch;

	.tabs-list {
		flex-shrink: 0;
		min-width: 200px;
		padding-bottom: 0.5rem;
	}

	.tabs-panels {
		flex: 1;
	}

	/* Panel border adjustment - remove left border (adjacent to tabs) */
	.tab-panel {
		border-left: none;
		border-top-left-radius: 0;
		border-bottom-left-radius: 0;
	}
}

/* Vertical-right layout: nav on right, content on left */
.gutplus-tabs[data-orientation="vertical-right"] {
	display: flex;
	flex-direction: row-reverse;
	gap: 0;
	align-items: stretch;

	.tabs-list {
		flex-shrink: 0;
		min-width: 200px;
		padding-bottom: 0.5rem;
	}

	.tabs-panels {
		flex: 1;
	}

	/* Panel border adjustment - remove right border (adjacent to tabs) */
	.tab-panel {
		border-right: none;
		border-top-right-radius: 0;
		border-bottom-right-radius: 0;
	}
}

/* Responsive adjustments */
@media (max-width: 768px) {

	.tab-button {
		padding: 0.625rem 1rem;
		font-size: 0.95rem;
	}

	.tab-panel-inner {
		padding: 1rem;
	}

	.tabs-list {
		gap: 0.25rem;
	}

	/* Hide tab navigation and show accordion on mobile if responsive fallback enabled */
	.gutplus-tabs.responsive-accordion {

		.tabs-list,
		.tabs-panels {
			display: none;
		}

		.accordion-fallback {
			display: block;
		}
	}
}

/* Accessibility - Reduced motion */
@media (prefers-reduced-motion: reduce) {

	.tab-button,
	.tab-panel,
	.tab-icon,
	.accordion-button,
	.accordion-panel {
		transition: none !important;
		animation: none !important;
	}
}
