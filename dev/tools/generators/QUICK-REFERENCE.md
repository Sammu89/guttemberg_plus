# Structure JSX Generator - Quick Reference

## Import and Basic Usage

```javascript
const generator = require('./build-tools/generators/structure-jsx-generator.js');

// Generate complete JSX code with headers
const code = generator.generateStructureJsx(structureMapping, 'save');

// Generate only render title function
const titleCode = generator.generateRenderTitle(structureMapping, 'save');

// Generate only block content
const contentCode = generator.generateBlockContent(structureMapping, 'save');
```

## Pattern Detection

```javascript
// Detect which pattern a structure mapping uses
const pattern = generator.detectBlockPattern(structureMapping);
// Returns: 'accordion' | 'tabs' | 'toc'

// Get list of supported patterns
const patterns = generator.getSupportedPatterns();
// Returns: ['accordion', 'tabs', 'toc']
```

## Validation

```javascript
// Validate a structure mapping
const validation = generator.validateStructureMapping(structureMapping);

if (validation.valid) {
  console.log('Valid!', validation.blockPattern);
} else {
  console.log('Errors:', validation.errors);
}

// Validation result structure:
// {
//   valid: boolean,
//   errors: string[],
//   blockPattern: string
// }
```

## Modes

### Save Mode
Generates code for frontend rendering:
```javascript
const saveCode = generator.generateStructureJsx(structureMapping, 'save');
```

Features:
- `RichText.Content` (static)
- `InnerBlocks.Content` (static)
- ARIA attributes
- No event handlers

### Edit Mode
Generates code for editor interface:
```javascript
const editCode = generator.generateStructureJsx(structureMapping, 'edit');
```

Features:
- `RichText` with onChange
- `InnerBlocks` with options
- Event handlers
- Interactive editing

## Pattern Requirements

### Accordion
```javascript
{
  "structure": {
    "elements": {
      "titleWrapper": { "classes": ["accordion-title-wrapper"], ... },
      "content": { "classes": ["accordion-content"], ... },
      "contentInner": { "classes": ["accordion-content-inner"], ... }
    }
  }
}
```

### Tabs
```javascript
{
  "structure": {
    "elements": {
      "wrapper": { "classes": ["gutplus-tabs"], ... },
      "tabsList": { "classes": ["tabs-list"], ... },
      "tabsPanels": { "classes": ["tabs-panels"], ... }
    }
  }
}
```

### TOC
```javascript
{
  "structure": {
    "elements": {
      "wrapper": { "classes": ["gutplus-toc"], ... },
      "titleStatic": { "classes": ["toc-title"], ... },  // OR titleButton
      "content": { "classes": ["toc-content"], ... },
      "list": { "classes": ["toc-list"], ... }
    }
  }
}
```

## Complete Example

```javascript
const fs = require('fs');
const generator = require('./build-tools/generators/structure-jsx-generator.js');

// Load structure mapping
const structureMapping = require('./schemas/accordion-structure-mapping-autogenerated.json');

// Validate first
const validation = generator.validateStructureMapping(structureMapping);
if (!validation.valid) {
  console.error('Invalid structure:', validation.errors);
  process.exit(1);
}

// Detect pattern
const pattern = generator.detectBlockPattern(structureMapping);
console.log('Detected pattern:', pattern);

// Generate code for both modes
const saveCode = generator.generateStructureJsx(structureMapping, 'save');
const editCode = generator.generateStructureJsx(structureMapping, 'edit');

// Write to files
fs.writeFileSync('generated-save.js', saveCode);
fs.writeFileSync('generated-edit.js', editCode);

console.log('âœ“ Code generated successfully!');
```

## Error Handling

```javascript
try {
  const code = generator.generateStructureJsx(structureMapping, 'save');
} catch (error) {
  if (error.message.includes('Unsupported block pattern')) {
    console.error('Unknown pattern:', error.message);
  } else if (error.message.includes('No elements found')) {
    console.error('Invalid structure mapping:', error.message);
  } else {
    console.error('Generation error:', error.message);
  }
}
```

## Common Patterns

### Validate Before Generate
```javascript
const validation = generator.validateStructureMapping(mapping);
if (validation.valid) {
  const code = generator.generateStructureJsx(mapping, mode);
  // Use code...
} else {
  console.error('Validation failed:', validation.errors.join(', '));
}
```

### Generate for Multiple Patterns
```javascript
const patterns = ['accordion', 'tabs', 'toc'];
const codes = {};

patterns.forEach(pattern => {
  const mapping = require(`./schemas/${pattern}-structure-mapping-autogenerated.json`);
  codes[pattern] = {
    save: generator.generateStructureJsx(mapping, 'save'),
    edit: generator.generateStructureJsx(mapping, 'edit')
  };
});
```

### Check Pattern Support
```javascript
const supportedPatterns = generator.getSupportedPatterns();
const myPattern = 'carousel';

if (supportedPatterns.includes(myPattern)) {
  // Pattern is supported
} else {
  console.warn(`Pattern '${myPattern}' is not supported yet`);
}
```

## Output Structure

Generated code includes:

1. **Header Comment**
   ```javascript
   /* ========== AUTO-GENERATED-RENDER-TITLE-START ========== */
   // DO NOT EDIT - This code is auto-generated from schema
   // AUTO-GENERATED from schemas/accordion-structure-mapping-autogenerated.json
   // To modify, update the schema and run: npm run schema:build
   ```

2. **Render Function** (pattern-specific)
   - Accordion: `renderTitle()`
   - Tabs: `renderTabButtons()`
   - TOC: `renderHeader()`

3. **Footer Comment**
   ```javascript
   /* ========== AUTO-GENERATED-RENDER-TITLE-END ========== */
   ```

## Testing

```javascript
// Test pattern detection
const pattern = generator.detectBlockPattern(mapping);
console.assert(pattern === 'accordion', 'Pattern detection failed');

// Test validation
const validation = generator.validateStructureMapping(mapping);
console.assert(validation.valid === true, 'Validation failed');

// Test generation
const code = generator.generateStructureJsx(mapping, 'save');
console.assert(code.includes('renderTitle'), 'Code generation failed');
```

## Tips

1. **Always validate** before generating code
2. **Use pattern detection** to verify structure mappings
3. **Handle errors gracefully** with try/catch
4. **Test both modes** (save and edit) when developing
5. **Check element classes** match your CSS
6. **Review generated code** before committing

## Debugging

```javascript
// Debug pattern detection
const elements = structureMapping.structure.elements;
console.log('Element IDs:', Object.keys(elements));
const pattern = generator.detectBlockPattern(structureMapping);
console.log('Detected pattern:', pattern);

// Debug validation
const validation = generator.validateStructureMapping(structureMapping);
console.log('Valid:', validation.valid);
if (!validation.valid) {
  console.log('Errors:');
  validation.errors.forEach(error => console.log('  -', error));
}

// Debug generation
const code = generator.generateRenderTitle(structureMapping, 'save');
console.log('Generated code length:', code.length);
console.log('Contains expected function:', code.includes('const render'));
```

## Related Files

- `structure-jsx-generator.js` - Main generator code
- `STRUCTURE-JSX-GENERATOR-ARCHITECTURE.md` - Detailed architecture documentation
- `BLOCK-PATTERNS.md` - Pattern reference with visual diagrams
- `schemas/*-structure-mapping-autogenerated.json` - Structure mapping files

## CLI Usage

```bash
# Test pattern detection
node -e "
const gen = require('./build-tools/generators/structure-jsx-generator.js');
const map = require('./schemas/accordion-structure-mapping-autogenerated.json');
console.log(gen.detectBlockPattern(map));
"

# Validate structure
node -e "
const gen = require('./build-tools/generators/structure-jsx-generator.js');
const map = require('./schemas/tabs-structure-mapping-autogenerated.json');
const v = gen.validateStructureMapping(map);
console.log('Valid:', v.valid);
"

# Generate code
node -e "
const gen = require('./build-tools/generators/structure-jsx-generator.js');
const map = require('./schemas/toc-structure-mapping-autogenerated.json');
const code = gen.generateStructureJsx(map, 'save');
console.log(code);
"
```
