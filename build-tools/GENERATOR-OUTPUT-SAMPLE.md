# Save.js Style Generator - Output Samples

## Generated Code for All Three Blocks

This document shows the actual generated code from the save-styles-injector generator for accordion, tabs, and toc blocks.

---

## Accordion Block

### Statistics
- **Block Type:** accordion
- **Block Name:** Accordion
- **Themeable Attributes with CSS Variables:** 26

### Required Imports
```javascript
import { getCssVarName, formatCssValue } from '@shared/config/css-var-mappings-generated';
```

### Generated Function
```javascript
/**
 * Build inline CSS variables ONLY for explicit customizations (Tier 3)
 * Theme values (Tier 2) are applied via CSS classes generated by PHP
 * CSS defaults (Tier 1) are in the stylesheet
 *
 * The `customizations` attribute contains ONLY deltas from expected values
 * (calculated in edit.js by comparing attributes to defaults + theme)
 *
 * Uses auto-generated mappings from schema (single source of truth)
 */
const getCustomizationStyles = () => {
  const styles = {};

  // Get customizations (deltas from expected values, calculated in edit.js)
  const customizations = attributes.customizations || {};

  // Process each customization using schema-generated mappings
  Object.entries( customizations ).forEach( ( [ attrName, value ] ) => {
    if ( value === null || value === undefined ) {
      return;
    }

    // Get CSS variable name from generated mappings
    const cssVar = getCssVarName( attrName, 'accordion' );
    if ( ! cssVar ) {
      return; // Attribute not mapped to a CSS variable
    }

    // Format value with proper unit from generated mappings
    const formattedValue = formatCssValue( attrName, value, 'accordion' );
    if ( formattedValue !== null ) {
      styles[ cssVar ] = formattedValue;
    }
  } );

  return styles;
};
```

### CSS Variables Mapped (26 total)
```
--accordion-title-color
--accordion-title-bg
--accordion-title-hover-color
--accordion-title-hover-bg
--accordion-content-color
--accordion-content-bg
--accordion-border-color
--accordion-divider-color
--accordion-icon-color
--accordion-title-font-size
--accordion-title-font-weight
--accordion-title-font-style
--accordion-title-text-transform
--accordion-title-text-decoration
--accordion-title-alignment
--accordion-content-font-size
--accordion-content-font-weight
--accordion-border-width
--accordion-border-style
--accordion-border-radius
--accordion-border-shadow
--accordion-border-shadow-hover
--accordion-divider-width
--accordion-divider-style
--accordion-icon-size
--accordion-icon-rotation
```

---

## Tabs Block

### Statistics
- **Block Type:** tabs
- **Block Name:** Tabs
- **Themeable Attributes with CSS Variables:** 45

### Required Imports
```javascript
import { getCssVarName, formatCssValue } from '@shared/config/css-var-mappings-generated';
```

### Generated Function
```javascript
/**
 * Build inline CSS variables ONLY for explicit customizations (Tier 3)
 * Theme values (Tier 2) are applied via CSS classes generated by PHP
 * CSS defaults (Tier 1) are in the stylesheet
 *
 * The `customizations` attribute contains ONLY deltas from expected values
 * (calculated in edit.js by comparing attributes to defaults + theme)
 *
 * Uses auto-generated mappings from schema (single source of truth)
 */
const getCustomizationStyles = () => {
  const styles = {};

  // Get customizations (deltas from expected values, calculated in edit.js)
  const customizations = attributes.customizations || {};

  // Process each customization using schema-generated mappings
  Object.entries( customizations ).forEach( ( [ attrName, value ] ) => {
    if ( value === null || value === undefined ) {
      return;
    }

    // Get CSS variable name from generated mappings
    const cssVar = getCssVarName( attrName, 'tabs' );
    if ( ! cssVar ) {
      return; // Attribute not mapped to a CSS variable
    }

    // Format value with proper unit from generated mappings
    const formattedValue = formatCssValue( attrName, value, 'tabs' );
    if ( formattedValue !== null ) {
      styles[ cssVar ] = formattedValue;
    }
  } );

  return styles;
};
```

### CSS Variables Mapped (45 total)
```
--tab-show-icon
--tab-icon-color
--tab-icon-size
--tab-icon-rotation
--tab-button-color
--tab-button-bg
--tab-button-hover-color
--tab-button-hover-bg
--tab-button-active-color
--tab-button-active-bg
--tab-button-active-border-color
--tab-button-active-border-bottom-color
--tabs-button-border-color
--tabs-button-border-width
--tabs-button-border-style
--tabs-button-border-radius
--tabs-button-border-shadow
--tabs-button-border-shadow-hover
--tabs-focus-border-color
--tabs-focus-border-color-active
--tabs-focus-border-width
--tabs-focus-border-style
--tab-button-font-size
--tab-button-font-weight
--tab-button-font-style
--tab-button-text-transform
--tab-button-text-decoration
--tab-button-text-align
--tab-list-bg
--tab-list-align
--tab-panel-bg
--tab-panel-color
--tabs-panel-border-color
--tabs-panel-border-width
--tabs-panel-border-style
--tabs-panel-border-radius
--tabs-border-color
--tabs-border-width
--tabs-border-style
--tabs-border-radius
--tabs-border-shadow
--tabs-border-shadow-hover
--tabs-divider-border-color
--tabs-divider-border-width
--tabs-divider-border-style
```

### Note: Feature Toggles

Tabs block has feature toggles (`enableFocusBorder`, `enableDividerBorder`). Add this custom logic BEFORE the generated code:

```javascript
const getCustomizationStyles = () => {
  const styles = {};

  // CUSTOM LOGIC: Handle feature toggles
  if ( attributes.enableFocusBorder === false ) {
    styles['--tabs-focus-border-color'] = 'transparent';
    styles['--tabs-focus-border-color-active'] = 'transparent';
    styles['--tabs-focus-border-width'] = '0';
    styles['--tabs-focus-border-style'] = 'none';
  }

  if ( attributes.enableDividerBorder === false ) {
    styles['--tabs-divider-border-color'] = 'transparent';
    styles['--tabs-divider-border-width'] = '0';
    styles['--tabs-divider-border-style'] = 'none';
  }

  // GENERATED CODE: Standard delta-based mapping
  const customizations = attributes.customizations || {};
  Object.entries( customizations ).forEach( ( [ attrName, value ] ) => {
    // ... generated code ...
  } );

  return styles;
};
```

---

## ToC Block

### Statistics
- **Block Type:** toc
- **Block Name:** Table of Contents
- **Themeable Attributes with CSS Variables:** 44

### Required Imports
```javascript
import { getCssVarName, formatCssValue } from '@shared/config/css-var-mappings-generated';
```

### Generated Function
```javascript
/**
 * Build inline CSS variables ONLY for explicit customizations (Tier 3)
 * Theme values (Tier 2) are applied via CSS classes generated by PHP
 * CSS defaults (Tier 1) are in the stylesheet
 *
 * The `customizations` attribute contains ONLY deltas from expected values
 * (calculated in edit.js by comparing attributes to defaults + theme)
 *
 * Uses auto-generated mappings from schema (single source of truth)
 */
const getCustomizationStyles = () => {
  const styles = {};

  // Get customizations (deltas from expected values, calculated in edit.js)
  const customizations = attributes.customizations || {};

  // Process each customization using schema-generated mappings
  Object.entries( customizations ).forEach( ( [ attrName, value ] ) => {
    if ( value === null || value === undefined ) {
      return;
    }

    // Get CSS variable name from generated mappings
    const cssVar = getCssVarName( attrName, 'toc' );
    if ( ! cssVar ) {
      return; // Attribute not mapped to a CSS variable
    }

    // Format value with proper unit from generated mappings
    const formattedValue = formatCssValue( attrName, value, 'toc' );
    if ( formattedValue !== null ) {
      styles[ cssVar ] = formattedValue;
    }
  } );

  return styles;
};
```

### CSS Variables Mapped (44 total)
```
--toc-wrapper-background-color
--toc-border-color
--toc-title-color
--toc-title-background-color
--toc-link-color
--toc-link-hover-color
--toc-link-active-color
--toc-link-visited-color
--toc-numbering-color
--toc-level1-color
--toc-level2-color
--toc-level3-plus-color
--toc-collapse-icon-color
--toc-title-font-size
--toc-title-font-weight
--toc-title-text-transform
--toc-title-alignment
--toc-level1-font-size
--toc-level1-font-weight
--toc-level1-font-style
--toc-level1-text-transform
--toc-level1-text-decoration
--toc-level2-font-size
--toc-level2-font-weight
--toc-level2-font-style
--toc-level2-text-transform
--toc-level2-text-decoration
--toc-level3-plus-font-size
--toc-level3-plus-font-weight
--toc-level3-plus-font-style
--toc-level3-plus-text-transform
--toc-level3-plus-text-decoration
--toc-border-width
--toc-border-style
--toc-border-radius
--toc-border-shadow
--toc-border-shadow-hover
--toc-wrapper-padding
--toc-list-padding-left
--toc-item-spacing
--toc-level-indent
--toc-position-top
--toc-z-index
--toc-collapse-icon-size
```

---

## Usage Example

### 1. Import Helper Functions

At the top of save.js:

```javascript
import { useBlockProps, RichText, InnerBlocks } from '@wordpress/block-editor';
import { getAllEffectiveValues } from '@shared';
import { getCssVarName, formatCssValue } from '@shared/config/css-var-mappings-generated';
```

### 2. Add Generated Function

Inside the Save component, after `effectiveValues`:

```javascript
export default function Save( { attributes } ) {
  const effectiveValues = getAllEffectiveValues(
    attributes,
    {},
    allDefaults,
    'accordion'
  );

  // ADD GENERATED FUNCTION HERE
  const getCustomizationStyles = () => {
    // ... generated code ...
  };

  const customizationStyles = getCustomizationStyles();

  // ... rest of component ...
}
```

### 3. Apply Styles to JSX

In the blockProps:

```javascript
const blockProps = useBlockProps.save( {
  className: classNames.join( ' ' ),
  'data-accordion-id': accordionId,
  ...( Object.keys( customizationStyles ).length > 0 && { style: customizationStyles } ),
} );
```

---

## Example Input/Output

### Input (customizations attribute)

```javascript
attributes.customizations = {
  titleColor: '#ff0000',
  borderWidth: 2,
  borderRadius: {
    topLeft: 8,
    topRight: 8,
    bottomRight: 8,
    bottomLeft: 8
  }
}
```

### Output (inline styles)

**Accordion:**
```javascript
{
  '--accordion-title-color': '#ff0000',
  '--accordion-border-width': '2px',
  '--accordion-border-radius': '8px 8px 8px 8px'
}
```

**Tabs:**
```javascript
{
  '--tab-button-color': '#ff0000',
  '--tabs-border-width': '2px',
  '--tabs-border-radius': '8px 8px 8px 8px'
}
```

**ToC:**
```javascript
{
  '--toc-title-color': '#ff0000',
  '--toc-border-width': '2px',
  '--toc-border-radius': '8px 8px 8px 8px'
}
```

### Rendered HTML

```html
<div class="wp-block-accordion accordion-theme-modern"
     style="--accordion-title-color: #ff0000; --accordion-border-width: 2px; --accordion-border-radius: 8px 8px 8px 8px">
  <!-- content -->
</div>
```

**Key Points:**
- Theme class provides Tier 2 defaults (`.accordion-theme-modern`)
- Inline CSS variables override specific customizations (Tier 3)
- CSS defaults in stylesheet provide Tier 1 base
- CSS cascade handles the rest

---

## Generator Command

To regenerate these samples:

```bash
node build-tools/test-save-styles-generator.js
```

---

## Files Reference

- **Generator:** `build-tools/generators/save-styles-injector.js`
- **Test Script:** `build-tools/test-save-styles-generator.js`
- **Helper Functions:** `shared/src/config/css-var-mappings-generated.js`
- **Current Implementations:**
  - `blocks/accordion/src/save.js` (lines 54-86) - Delta-based ✅
  - `blocks/tabs/src/save.js` (lines 53-115) - All attributes with toggles
  - `blocks/toc/src/save.js` (lines 207-230) - All attributes

---

## Comparison: Current vs Generated

### Accordion - Already Matches! ✅

The current accordion save.js implementation **exactly matches** the generated code (except for special width handling).

### Tabs - Needs Migration

Current approach iterates through ALL attributes. Should migrate to delta-based approach with toggle logic added before the loop.

### ToC - Needs Migration

Current approach iterates through ALL attributes. Should migrate to delta-based approach for consistency and efficiency.

---

## Conclusion

The generator produces clean, efficient, delta-based code that leverages the 3-tier CSS cascade. The accordion block already implements this pattern perfectly. Tabs and ToC should be migrated to this approach for consistency and performance.
